{"version":3,"file":"corePackages/geoview-footer-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-footer-panel/src/details-item.tsx","webpack://geoview-core/../geoview-footer-panel/src/legend-item.tsx","webpack://geoview-core/../geoview-footer-panel/src/data-item.tsx","webpack://geoview-core/../geoview-footer-panel/src/index.tsx"],"sourcesContent":["/* eslint-disable react/require-default-props */\nimport type React from 'react';\nimport {\n  TypeWindow,\n  payloadIsAMapMouseEvent,\n  payloadIsAllQueriesDone,\n  TypeArrayOfLayerData,\n  getLocalizedValue,\n  Coordinate,\n} from 'geoview-core';\n\ninterface Props {\n  mapId: string;\n}\n\nconst w = window as TypeWindow;\n\n/**\n * Create an element that displays the details component\n *\n * @returns {JSX.Element} created details component\n */\nexport function DetailsItem({ mapId }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, react } = cgpv;\n\n  const { useState, useEffect } = react;\n\n  const [details, setDetails] = useState<TypeArrayOfLayerData>([]);\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const [list, setList] = useState<React.ReactElement>();\n  const [lngLat, setLngLat] = useState<Coordinate>([]);\n  const [handlerName, setHandlerName] = useState<string | null>(null);\n\n  useEffect(() => {\n    // create the listener to return the details\n    api.event.on(\n      api.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE,\n      (payload) => {\n        if (payloadIsAllQueriesDone(payload)) {\n          const { resultSets } = payload;\n          const newDetails: TypeArrayOfLayerData = [];\n          Object.keys(resultSets).forEach((layerPath) => {\n            const layerName = getLocalizedValue(api.map(mapId).layer.registeredLayers[layerPath].layerName, mapId)!;\n            const features = resultSets[layerPath]!;\n            if (features.length > 0) {\n              newDetails.push({ layerPath, layerName, features });\n            }\n          });\n          if (newDetails.length > 0) {\n            setDetails(newDetails);\n          } else {\n            setDetails([]);\n          }\n        } else {\n          setDetails([]);\n        }\n      },\n      `${mapId}/$FeatureInfoLayerSet$`\n    );\n    api.event.on(\n      api.eventNames.MAP.EVENT_MAP_SINGLE_CLICK,\n      (payload) => {\n        if (payloadIsAMapMouseEvent(payload)) {\n          const { coordinates } = payload;\n          setHandlerName(payload.handlerName);\n          setLngLat(coordinates.lnglat);\n        } else {\n          setLngLat([]);\n        }\n      },\n      mapId\n    );\n    return () => {\n      api.event.off(api.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE, mapId);\n      api.event.off(api.eventNames.MAP.EVENT_MAP_SINGLE_CLICK, mapId);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    setList(api.map(mapId).details.createDetails(mapId, details, { mapId, location: lngLat, handlerName }));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [details, lngLat]);\n\n  return <div>{list}</div>;\n}\n","/* eslint-disable react/require-default-props */\nimport type React from 'react';\nimport { TypeWindow, payloadIsALayerConfig, payloadIsRemoveGeoViewLayer } from 'geoview-core';\n\ninterface Props {\n  mapId: string;\n}\nconst w = window as TypeWindow;\n\n/**\n * Create an element that displays the legend component\n *\n * @returns {JSX.Element} created legend component\n */\nexport function LegendItem({ mapId }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, react } = cgpv;\n\n  const { useState, useEffect } = react;\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const [legend, setLegend] = useState<React.DetailedReactHTMLElement<{}, HTMLElement>>();\n  const [mapLayers, setMapLayers] = useState<string[]>([]);\n\n  const updateLayers = () => {\n    if (api.map(mapId).layer?.layerOrder !== undefined) setMapLayers([...api.map(mapId).layer.layerOrder].reverse());\n  };\n\n  useEffect(() => {\n    api.event.on(\n      api.eventNames.MAP.EVENT_MAP_LOADED,\n      () => {\n        updateLayers();\n      },\n      mapId\n    );\n    api.event.on(\n      api.eventNames.LAYER.EVENT_REMOVE_LAYER,\n      (payload) => {\n        if (payloadIsRemoveGeoViewLayer(payload)) {\n          setMapLayers((orderedLayers) => orderedLayers.filter((layerId) => layerId !== payload.geoviewLayer.geoviewLayerId));\n        }\n      },\n      mapId\n    );\n    api.event.on(\n      api.eventNames.LAYER.EVENT_ADD_LAYER,\n      (payload) => {\n        if (payloadIsALayerConfig(payload)) {\n          api.event.on(\n            api.eventNames.LAYER.EVENT_LAYER_ADDED,\n            () => {\n              updateLayers();\n              api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, `${mapId}/${payload.layerConfig.geoviewLayerId}`);\n            },\n            `${mapId}/${payload.layerConfig.geoviewLayerId}`\n          );\n        }\n      },\n      mapId\n    );\n    return () => {\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId);\n      api.event.off(api.eventNames.LAYER.EVENT_ADD_LAYER, mapId);\n      api.event.off(api.eventNames.LAYER.EVENT_REMOVE_LAYER, mapId);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    setLegend(api.map(mapId).legend.createLegend({ layerIds: mapLayers, isRemoveable: false, canSetOpacity: true, canZoomTo: true }));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mapLayers]);\n\n  return <div>{legend}</div>;\n}\n","/* eslint-disable react/require-default-props */\nimport { TypeWindow, getLocalizedValue, TypeTabs, AbstractGeoViewVector, TypeListOfLayerEntryConfig } from 'geoview-core';\n\ninterface Props {\n  mapId: string;\n}\nconst w = window as TypeWindow;\n\n/**\n * Create an element that displays the data grid footer component\n *\n * @returns {JSX.Element} created data grid footer component\n */\nexport function DataItem({ mapId }: Props): JSX.Element {\n  const { cgpv } = w;\n  const { api, ui, react } = cgpv;\n  const { Tabs } = ui.elements;\n  const {\n    utilities: { isVectorLayer },\n  } = api;\n  const { useState, useEffect } = react;\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  const [dataLayers, setDataLayers] = useState<string[]>([]);\n\n  useEffect(() => {\n    setDataLayers(Object.keys(api.map(mapId!).layer.geoviewLayers));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [api, mapId]);\n\n  setTimeout(() => {\n    dataLayers.forEach((layerId) => {\n      const layerSelection = document.getElementById(`${layerId}-groupLayerSelection`);\n      if (layerSelection) {\n        (layerSelection as HTMLSelectElement).addEventListener('change', function onChange(this) {\n          const { selectedIndex } = this;\n          const datagridTables = document.getElementsByClassName(`${layerId}-layer-datagrid-table`);\n          if (datagridTables.length > 0) {\n            for (let i = 0; i < datagridTables.length; i++) {\n              (datagridTables[i] as HTMLDivElement).setAttribute('style', `display:${i !== selectedIndex ? 'none' : 'block'}`);\n            }\n          }\n        });\n      }\n    });\n  }, 2000);\n\n  /**\n   * Extract layers keys from layer entry config of geoviewinstance\n   * @param geoviewLayerInstance layer instance which hold all properties of layer rendered on map.\n   * @param layerId id of the layer rendered on the map.\n   * @returns array of layer keys.\n   */\n  const getLayerKeys = (geoviewLayerInstance: AbstractGeoViewVector, layerId: string): string[] => {\n    const groupLayerKeys: string[] = [];\n    if (\n      geoviewLayerInstance.listOfLayerEntryConfig.length > 0 &&\n      (geoviewLayerInstance as AbstractGeoViewVector).getAllFeatureInfo !== undefined\n    ) {\n      const getGroupKeys = (listOfLayerEntryConfig: TypeListOfLayerEntryConfig, parentLayerId: string) => {\n        listOfLayerEntryConfig.forEach((LayerEntryConfig) => {\n          if (\n            LayerEntryConfig.entryType === 'group' &&\n            LayerEntryConfig.listOfLayerEntryConfig !== undefined &&\n            LayerEntryConfig.listOfLayerEntryConfig.length > 1\n          ) {\n            getGroupKeys(LayerEntryConfig.listOfLayerEntryConfig, `${parentLayerId}/${LayerEntryConfig.layerId}`);\n          } else if (LayerEntryConfig.entryType !== 'group') {\n            groupLayerKeys.push(`${parentLayerId}/${LayerEntryConfig.layerId}`);\n          }\n        });\n      };\n      getGroupKeys(geoviewLayerInstance.listOfLayerEntryConfig, layerId);\n    }\n    return isVectorLayer(geoviewLayerInstance) ? groupLayerKeys : [];\n  };\n\n  return (\n    <Tabs\n      tabsProps={{\n        variant: 'scrollable',\n      }}\n      tabs={dataLayers.map((layerId, index): TypeTabs => {\n        const geoviewLayerInstance = api.map(mapId).layer.geoviewLayers[layerId] as AbstractGeoViewVector;\n        const labelValue = getLocalizedValue(geoviewLayerInstance.geoviewLayerName, mapId);\n        const layerKeys = getLayerKeys(geoviewLayerInstance, layerId);\n\n        // TODO: needs refactor here for group layers.\n        return {\n          value: index,\n          label: labelValue !== undefined ? labelValue : `data-${index}`,\n          content: () =>\n            api.map(mapId).dataGrid.createDataGrid({\n              layerId,\n            }),\n        };\n      })}\n    />\n  );\n}\n","import {\n  Cast,\n  AbstractPlugin,\n  TypePluginOptions,\n  TypeButtonPanel,\n  TypeWindow,\n  toJsonObject,\n  TypeJsonObject,\n  AnySchemaObject,\n  payloadIsAllQueriesDone,\n  TypeArrayOfFeatureInfoEntries,\n} from 'geoview-core';\n\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-footer-panel.json';\nimport { DetailsItem } from './details-item';\nimport { LegendItem } from './legend-item';\nimport { DataItem } from './data-item';\n\nconst w = window as TypeWindow;\n\ntype CustomTabs = {\n  title: string;\n  contentHTML: string;\n};\n\n/**\n * Create a class for the plugin instance\n */\nclass FooterPanelPlugin extends AbstractPlugin {\n  // store the created button panel object\n  buttonPanel: TypeButtonPanel | null;\n\n  constructor(pluginId: string, props: TypePluginOptions) {\n    super(pluginId, props);\n    this.buttonPanel = null;\n  }\n\n  /**\n   * Return the package schema\n   *\n   * @returns {AnySchemaObject} the package schema\n   */\n  schema = (): AnySchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations = toJsonObject({\n    en: {\n      legend: 'Legend',\n      details: 'Details',\n      dataGrid: 'Data',\n    },\n    fr: {\n      legend: 'Légende',\n      details: 'Détails',\n      dataGrid: 'Données',\n    },\n  });\n\n  /**\n   * Added function called after the plugin has been initialized\n   */\n  added = (): void => {\n    const { configObj, pluginProps } = this;\n\n    const { mapId } = pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      const { api } = cgpv;\n      const { displayLanguage, footerTabs, map } = api.map(mapId);\n\n      const mapContainer = map.getTargetElement().parentElement;\n      // Set size of map container based on whether footer-panel is collapsed or not\n      if (mapContainer) {\n        if (configObj?.collapsed === false) {\n          mapContainer.style.height = 'calc( 100% - 300px )';\n        } else {\n          mapContainer.style.height = 'calc( 100% - 55px )';\n        }\n      }\n\n      const defaultTabs = configObj?.tabs.defaultTabs as Array<string>;\n      let tabsCounter = 0;\n\n      if (defaultTabs.includes('legend')) {\n        // create new tab and add the LegendComponent to the footer tab\n        footerTabs.createFooterTab({\n          value: tabsCounter,\n          label: this.translations[displayLanguage].legend as string,\n          content: () => <LegendItem mapId={mapId} />,\n        });\n        tabsCounter++;\n      }\n\n      // create the listener to return the details\n      if (defaultTabs.includes('details')) {\n        // create new tab and add the DetailComponent to the footer tab\n        const detailsTabValue = tabsCounter;\n        footerTabs.createFooterTab({\n          value: detailsTabValue,\n          label: this.translations[displayLanguage].details as string,\n          content: () => <DetailsItem mapId={mapId} />,\n        });\n        tabsCounter++;\n        // select the details tab when map click queries are done\n        api.event.on(\n          api.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE,\n          (payload) => {\n            if (payloadIsAllQueriesDone(payload)) {\n              const { resultSets } = payload;\n              let features: TypeArrayOfFeatureInfoEntries = [];\n              Object.keys(resultSets).forEach((layerPath) => {\n                features = features.concat(resultSets[layerPath]!);\n              });\n              if (features.length > 0) {\n                footerTabs.selectFooterTab(detailsTabValue);\n              }\n            }\n          },\n          `${mapId}/$FeatureInfoLayerSet$`\n        );\n      }\n\n      if (defaultTabs.includes('data-grid')) {\n        /// create new tab and add the DataGridComponent to the footer tab\n        footerTabs.createFooterTab({\n          value: tabsCounter,\n          label: this.translations[displayLanguage].dataGrid as string,\n          content: () => <DataItem mapId={mapId} />,\n        });\n        tabsCounter++;\n      }\n\n      // TODO add custom detail reusable component when done\n\n      const customTabs = configObj?.tabs.customTabs as Array<string>;\n      for (let i = 0; i < customTabs.length; i++) {\n        const tab = customTabs[i] as unknown as CustomTabs;\n\n        footerTabs.createFooterTab({\n          value: tabsCounter,\n          label: tab.title,\n          content: tab.contentHTML,\n        });\n        tabsCounter++;\n      }\n    }\n  };\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  removed(): void {\n    // const { mapId } = this.pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      // const { api } = cgpv;\n      // TODO: Enable the footer tabs removal\n    }\n  }\n}\n\nexport default FooterPanelPlugin;\n\nw.plugins = w.plugins || {};\nw.plugins['footer-panel'] = Cast<AbstractPlugin>(FooterPanelPlugin);\n"],"names":["w","window","DetailsItem","_ref","mapId","cgpv","api","react","useState","useEffect","_useState","_useState2","_slicedToArray","details","setDetails","_useState3","_useState4","list","setList","_useState5","_useState6","lngLat","setLngLat","_useState7","_useState8","handlerName","setHandlerName","event","on","eventNames","GET_FEATURE_INFO","ALL_QUERIES_DONE","payload","payloadIsAllQueriesDone","resultSets","newDetails","Object","keys","forEach","layerPath","layerName","getLocalizedValue","map","layer","registeredLayers","features","length","push","concat","MAP","EVENT_MAP_SINGLE_CLICK","payloadIsAMapMouseEvent","coordinates","lnglat","off","createDetails","location","_jsx","children","LegendItem","legend","setLegend","mapLayers","setMapLayers","updateLayers","_api$map$layer","undefined","layerOrder","_toConsumableArray","reverse","EVENT_MAP_LOADED","LAYER","EVENT_REMOVE_LAYER","payloadIsRemoveGeoViewLayer","orderedLayers","filter","layerId","geoviewLayer","geoviewLayerId","EVENT_ADD_LAYER","payloadIsALayerConfig","EVENT_LAYER_ADDED","layerConfig","createLegend","layerIds","isRemoveable","canSetOpacity","canZoomTo","DataItem","ui","Tabs","elements","isVectorLayer","utilities","dataLayers","setDataLayers","geoviewLayers","setTimeout","layerSelection","document","getElementById","addEventListener","selectedIndex","this","datagridTables","getElementsByClassName","i","setAttribute","tabsProps","variant","tabs","index","geoviewLayerInstance","labelValue","geoviewLayerName","groupLayerKeys","listOfLayerEntryConfig","getAllFeatureInfo","getGroupKeys","parentLayerId","LayerEntryConfig","entryType","getLayerKeys","value","label","content","dataGrid","createDataGrid","FooterPanelPlugin","_AbstractPlugin","_inherits","_super","_createSuper","pluginId","props","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","schema","toJsonObject","defaultConfig","en","fr","_assertThisInitialize","configObj","pluginProps","_api$map","displayLanguage","footerTabs","mapContainer","getTargetElement","parentElement","collapsed","style","height","defaultTabs","tabsCounter","includes","createFooterTab","translations","detailsTabValue","selectFooterTab","customTabs","tab","title","contentHTML","buttonPanel","_createClass","key","AbstractPlugin","plugins","Cast"],"sourceRoot":""}