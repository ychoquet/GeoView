{"version":3,"file":"corePackages/geoview-footer-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-footer-panel/src/footer-panel-legend-item.tsx","webpack://geoview-core/../geoview-footer-panel/src/data-table.tsx","webpack://geoview-core/../geoview-footer-panel/src/layers.tsx","webpack://geoview-core/../geoview-footer-panel/src/time-slider.tsx","webpack://geoview-core/../geoview-footer-panel/src/index.tsx"],"sourcesContent":["/* eslint-disable react/require-default-props */\r\nimport type React from 'react';\r\nimport { TypeWindow, payloadIsALayerConfig, payloadIsRemoveGeoViewLayer } from 'geoview-core';\r\nimport { LayerConfigPayload, PayloadBaseClass, TypeRemoveGeoviewLayerPayload } from 'geoview-core/src/api/events/payloads';\r\n\r\ninterface Props {\r\n  mapId: string;\r\n}\r\nconst w = window as TypeWindow;\r\n\r\n/**\r\n * Create an element that displays the legend component\r\n *\r\n * @returns {JSX.Element} created legend component\r\n */\r\nexport function FooterPanelLegendItem({ mapId }: Props): JSX.Element {\r\n  const { cgpv } = w;\r\n  const { api, react } = cgpv;\r\n\r\n  const { useState, useEffect } = react;\r\n\r\n  // eslint-disable-next-line @typescript-eslint/ban-types\r\n  const [legend, setLegend] = useState<React.DetailedReactHTMLElement<{}, HTMLElement>>();\r\n  const [mapLayers, setMapLayers] = useState<string[]>([]);\r\n\r\n  const updateLayers = () => {\r\n    if (api.maps[mapId].layer?.layerOrder !== undefined) setMapLayers([...api.maps[mapId].layer.layerOrder].reverse());\r\n  };\r\n\r\n  const eventMapLoadedListenerFunction = () => updateLayers();\r\n  const eventRemoveLayerListenerFunction = (payload: PayloadBaseClass) => {\r\n    if (payloadIsRemoveGeoViewLayer(payload)) {\r\n      setMapLayers((orderedLayers) =>\r\n        orderedLayers.filter((layerId) => layerId !== (payload as TypeRemoveGeoviewLayerPayload).geoviewLayer.geoviewLayerId)\r\n      );\r\n    }\r\n  };\r\n\r\n  const eventAddLayerListenerFunction = (payload: PayloadBaseClass) => {\r\n    if (payloadIsALayerConfig(payload)) {\r\n      api.event.on(\r\n        api.eventNames.LAYER.EVENT_LAYER_ADDED,\r\n        () => {\r\n          updateLayers();\r\n          api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, `${mapId}/${(payload as LayerConfigPayload).layerConfig.geoviewLayerId}`);\r\n        },\r\n        `${mapId}/${(payload as LayerConfigPayload).layerConfig.geoviewLayerId}`\r\n      );\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, eventMapLoadedListenerFunction, mapId);\r\n    api.event.on(api.eventNames.LAYER.EVENT_REMOVE_LAYER, eventRemoveLayerListenerFunction, mapId);\r\n    api.event.on(api.eventNames.LAYER.EVENT_ADD_LAYER, eventAddLayerListenerFunction, mapId);\r\n\r\n    return () => {\r\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, eventMapLoadedListenerFunction);\r\n      api.event.off(api.eventNames.LAYER.EVENT_REMOVE_LAYER, mapId, eventRemoveLayerListenerFunction);\r\n      api.event.off(api.eventNames.LAYER.EVENT_ADD_LAYER, mapId, eventAddLayerListenerFunction);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setLegend(api.maps[mapId].legend.createLegend({ layerIds: mapLayers, isRemoveable: false, canSetOpacity: true, canZoomTo: true }));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [mapLayers]);\r\n\r\n  return <div>{legend}</div>;\r\n}\r\n","import type React from 'react';\r\nimport { TypeWindow } from 'geoview-core';\r\n\r\ninterface DataTableProps {\r\n  mapId: string;\r\n}\r\n\r\nconst w = window as TypeWindow;\r\n\r\n/**\r\n * Create the datatable that displays in footer panel.\r\n *\r\n * @returns {JSX.Element} created data table component\r\n */\r\n\r\nexport function DataTable({ mapId }: DataTableProps) {\r\n  const { cgpv } = w;\r\n  const { api, react } = cgpv;\r\n  const { useState, useEffect } = react;\r\n\r\n  const [table, setTable] = useState(null);\r\n\r\n  /**\r\n   * Create data table from geo view layers.\r\n   */\r\n  const createDataTable = async () => {\r\n    const data = await cgpv.api.maps[mapId].dataTable.createDataPanel();\r\n    setTable(data);\r\n  };\r\n\r\n  /**\r\n   * get the table after map is loaded and timeout has been passed.\r\n   */\r\n  const getDataTable = () => {\r\n    setTimeout(() => {\r\n      createDataTable();\r\n    }, 1000);\r\n  };\r\n\r\n  useEffect(() => {\r\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, getDataTable, mapId);\r\n    return () => {\r\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, getDataTable);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return <div>{table}</div>;\r\n}\r\n","/* eslint-disable react/require-default-props */\r\nimport type React from 'react';\r\nimport { TypeWindow, payloadIsALayerConfig, payloadIsRemoveGeoViewLayer } from 'geoview-core';\r\nimport { LayerConfigPayload, PayloadBaseClass, TypeRemoveGeoviewLayerPayload } from 'geoview-core/src/api/events/payloads';\r\n\r\ninterface Props {\r\n  mapId: string;\r\n}\r\nconst w = window as TypeWindow;\r\n\r\n/**\r\n * Create an element that displays the layers component\r\n *\r\n * @returns {JSX.Element} created layers component\r\n */\r\nexport function Layers({ mapId }: Props): JSX.Element {\r\n  const { cgpv } = w;\r\n  const { api, react } = cgpv;\r\n\r\n  const { useState, useEffect } = react;\r\n\r\n  // eslint-disable-next-line @typescript-eslint/ban-types\r\n  const [layers, setLayers] = useState<React.DetailedReactHTMLElement<{}, HTMLElement>>();\r\n  const [mapLayers, setMapLayers] = useState<string[]>([]);\r\n\r\n  const updateLayers = () => {\r\n    if (api.maps[mapId].layer?.layerOrder !== undefined) setMapLayers([...api.maps[mapId].layer.layerOrder].reverse());\r\n  };\r\n\r\n  const eventMapLoadedListenerFunction = () => updateLayers();\r\n  const eventRemoveLayerListenerFunction = (payload: PayloadBaseClass) => {\r\n    if (payloadIsRemoveGeoViewLayer(payload)) {\r\n      setMapLayers((orderedLayers) =>\r\n        orderedLayers.filter((layerId) => layerId !== (payload as TypeRemoveGeoviewLayerPayload).geoviewLayer.geoviewLayerId)\r\n      );\r\n    }\r\n  };\r\n\r\n  const eventAddLayerListenerFunction = (payload: PayloadBaseClass) => {\r\n    if (payloadIsALayerConfig(payload)) {\r\n      api.event.on(\r\n        api.eventNames.LAYER.EVENT_LAYER_ADDED,\r\n        () => {\r\n          updateLayers();\r\n          api.event.off(api.eventNames.LAYER.EVENT_LAYER_ADDED, `${mapId}/${(payload as LayerConfigPayload).layerConfig.geoviewLayerId}`);\r\n        },\r\n        `${mapId}/${(payload as LayerConfigPayload).layerConfig.geoviewLayerId}`\r\n      );\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, eventMapLoadedListenerFunction, mapId);\r\n    api.event.on(api.eventNames.LAYER.EVENT_REMOVE_LAYER, eventRemoveLayerListenerFunction, mapId);\r\n    api.event.on(api.eventNames.LAYER.EVENT_ADD_LAYER, eventAddLayerListenerFunction, mapId);\r\n\r\n    return () => {\r\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, eventMapLoadedListenerFunction);\r\n      api.event.off(api.eventNames.LAYER.EVENT_REMOVE_LAYER, mapId, eventRemoveLayerListenerFunction);\r\n      api.event.off(api.eventNames.LAYER.EVENT_ADD_LAYER, mapId, eventAddLayerListenerFunction);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setLayers(api.maps[mapId].layers.createLayers({ layerIds: mapLayers, isRemoveable: false, canSetOpacity: true, canZoomTo: true }));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [mapLayers]);\r\n\r\n  return <div>{layers}</div>;\r\n}\r\n","import type React from 'react';\r\nimport { TypeWindow } from 'geoview-core';\r\n\r\ninterface TimeSliderProps {\r\n  mapId: string;\r\n}\r\n\r\nconst w = window as TypeWindow;\r\n\r\n/**\r\n * Create the range slider to display in the footer panel.\r\n *\r\n * @returns {JSX.Element} created range slider component\r\n */\r\n\r\nexport function TimeSlider({ mapId }: TimeSliderProps) {\r\n  const { cgpv } = w;\r\n  const { api, react } = cgpv;\r\n  const { useState, useEffect } = react;\r\n\r\n  const [slider, setSlider] = useState(null);\r\n\r\n  /**\r\n   * Create time slider from geo view layers.\r\n   */\r\n  const createTimeSlider = async () => {\r\n    const data = await cgpv.api.maps[mapId].timeSlider.createTimeSlider();\r\n    setSlider(data);\r\n  };\r\n\r\n  /**\r\n   * Get the time slider after map is loaded and timeout has passed.\r\n   */\r\n  const getTimeSlider = () => {\r\n    setTimeout(() => {\r\n      createTimeSlider();\r\n    }, 1000);\r\n  };\r\n\r\n  useEffect(() => {\r\n    api.event.on(api.eventNames.MAP.EVENT_MAP_LOADED, getTimeSlider, mapId);\r\n    return () => {\r\n      api.event.off(api.eventNames.MAP.EVENT_MAP_LOADED, mapId, getTimeSlider);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return <div>{slider}</div>;\r\n}\r\n","import {\r\n  Cast,\r\n  AbstractPlugin,\r\n  TypePluginOptions,\r\n  TypeButtonPanel,\r\n  TypeWindow,\r\n  toJsonObject,\r\n  TypeJsonObject,\r\n  AnySchemaObject,\r\n  payloadIsAllQueriesDone,\r\n  TypeArrayOfFeatureInfoEntries,\r\n  PayloadBaseClass,\r\n} from 'geoview-core';\r\n\r\nimport { HubOutlinedIcon, InfoOutlinedIcon, LayersOutlinedIcon, StorageIcon } from 'geoview-core/src/ui';\r\nimport schema from '../schema.json';\r\nimport defaultConfig from '../default-config-footer-panel.json';\r\nimport { FooterPanelLegendItem } from './footer-panel-legend-item';\r\nimport { DataTable } from './data-table';\r\nimport { Layers } from './layers';\r\nimport { TimeSlider } from './time-slider';\r\n\r\nconst w = window as TypeWindow;\r\n\r\ntype CustomTabs = {\r\n  title: string;\r\n  contentHTML: string;\r\n};\r\n\r\n/**\r\n * Create a class for the plugin instance\r\n */\r\nclass FooterPanelPlugin extends AbstractPlugin {\r\n  // store the created button panel object\r\n  buttonPanel: TypeButtonPanel | null;\r\n\r\n  constructor(pluginId: string, props: TypePluginOptions) {\r\n    super(pluginId, props);\r\n    this.buttonPanel = null;\r\n  }\r\n\r\n  /**\r\n   * Return the package schema\r\n   *\r\n   * @returns {AnySchemaObject} the package schema\r\n   */\r\n  schema = (): AnySchemaObject => schema;\r\n\r\n  /**\r\n   * Return the default config for this package\r\n   *\r\n   * @returns {TypeJsonObject} the default config\r\n   */\r\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\r\n\r\n  /**\r\n   * translations object to inject to the viewer translations\r\n   */\r\n  translations = toJsonObject({\r\n    en: {\r\n      legend: 'Legend',\r\n      layers: 'Layers',\r\n      details: 'Details',\r\n      dataTable: 'DataTable',\r\n      timeSlider: 'Time Slider',\r\n    },\r\n    fr: {\r\n      legend: 'Légende',\r\n      layers: 'Couches',\r\n      details: 'Détails',\r\n      dataTable: 'Données',\r\n      timeSlider: 'Curseur Temporel',\r\n    },\r\n  });\r\n\r\n  /**\r\n   * Added function called after the plugin has been initialized\r\n   */\r\n  added = (): void => {\r\n    const { configObj, pluginProps } = this as AbstractPlugin;\r\n\r\n    const { mapId } = pluginProps;\r\n\r\n    // access the cgpv object from the window object\r\n    const { cgpv } = w;\r\n\r\n    if (cgpv) {\r\n      // access the api calls\r\n      const { api } = cgpv;\r\n      const { displayLanguage, footerTabs } = api.maps[mapId];\r\n\r\n      const defaultTabs = configObj?.tabs.defaultTabs as Array<string>;\r\n      let tabsCounter = 0;\r\n\r\n      if (defaultTabs.includes('legend')) {\r\n        // create new tab and add the LegendComponent to the footer tab\r\n        footerTabs.createFooterTab({\r\n          value: tabsCounter,\r\n          label: this.translations[displayLanguage].legend as string,\r\n          content: () => <FooterPanelLegendItem mapId={mapId} />,\r\n          icon: <HubOutlinedIcon />,\r\n        });\r\n        tabsCounter++;\r\n      }\r\n\r\n      if (defaultTabs.includes('layers')) {\r\n        // create new tab and add the LayersComponent to the footer tab\r\n        footerTabs.createFooterTab({\r\n          value: tabsCounter,\r\n          label: this.translations[displayLanguage].layers as string,\r\n          content: () => <Layers mapId={mapId} />,\r\n          icon: <LayersOutlinedIcon />,\r\n        });\r\n        tabsCounter++;\r\n      }\r\n\r\n      // create the listener to return the details\r\n      if (defaultTabs.includes('details')) {\r\n        // create new tab and add the DetailComponent to the footer tab\r\n        const detailsTabValue = tabsCounter;\r\n        footerTabs.createFooterTab({\r\n          value: detailsTabValue,\r\n          label: this.translations[displayLanguage].details as string,\r\n          content: () => api.maps[mapId].details.createDetails(mapId),\r\n          icon: <InfoOutlinedIcon />,\r\n        });\r\n        tabsCounter++;\r\n        // select the details tab when map click queries are done\r\n        api.event.on(\r\n          api.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE,\r\n          (payload: PayloadBaseClass) => {\r\n            if (payloadIsAllQueriesDone(payload)) {\r\n              const { eventType, resultSets } = payload;\r\n              if (eventType === 'click') {\r\n                let features: TypeArrayOfFeatureInfoEntries = [];\r\n                Object.keys(resultSets).forEach((layerPath) => {\r\n                  features = features.concat(resultSets[layerPath]!);\r\n                });\r\n                if (features.length > 0) {\r\n                  footerTabs.selectFooterTab(detailsTabValue);\r\n                }\r\n              }\r\n            }\r\n          },\r\n          `${mapId}/FeatureInfoLayerSet`\r\n        );\r\n      }\r\n\r\n      if (defaultTabs.includes('data-table')) {\r\n        /// create new tab and add the DataTable Component to the footer tab\r\n        footerTabs.createFooterTab({\r\n          value: tabsCounter,\r\n          label: this.translations[displayLanguage].dataTable as string,\r\n          content: () => <DataTable mapId={mapId} />,\r\n          icon: <StorageIcon />,\r\n        });\r\n        tabsCounter++;\r\n      }\r\n\r\n      if (defaultTabs.includes('time-slider')) {\r\n        /// create new tab and add the DataTable Component to the footer tab\r\n        footerTabs.createFooterTab({\r\n          value: tabsCounter,\r\n          label: this.translations[displayLanguage].timeSlider as string,\r\n          content: () => <TimeSlider mapId={mapId} />,\r\n        });\r\n        tabsCounter++;\r\n      }\r\n\r\n      // TODO add custom detail reusable component when done\r\n\r\n      const customTabs = configObj?.tabs.customTabs as Array<string>;\r\n      for (let i = 0; i < customTabs.length; i++) {\r\n        const tab = customTabs[i] as unknown as CustomTabs;\r\n\r\n        footerTabs.createFooterTab({\r\n          value: tabsCounter,\r\n          label: tab.title,\r\n          content: tab.contentHTML,\r\n        });\r\n        tabsCounter++;\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Function called when the plugin is removed, used for clean up\r\n   */\r\n  removed(): void {\r\n    // const { mapId } = this.pluginProps;\r\n\r\n    // access the cgpv object from the window object\r\n    const { cgpv } = w;\r\n\r\n    if (cgpv) {\r\n      // access the api calls\r\n      // const { api } = cgpv;\r\n      // TODO: Enable the footer tabs removal\r\n    }\r\n  }\r\n}\r\n\r\nexport default FooterPanelPlugin;\r\n\r\nw.plugins = w.plugins || {};\r\nw.plugins['footer-panel'] = Cast<AbstractPlugin>(FooterPanelPlugin);\r\n"],"names":["w","window","FooterPanelLegendItem","_ref","mapId","cgpv","api","react","useState","useEffect","_useState","_useState2","_slicedToArray","legend","setLegend","_useState3","_useState4","mapLayers","setMapLayers","updateLayers","_api$maps$mapId$layer","undefined","maps","layer","layerOrder","_toConsumableArray","reverse","eventMapLoadedListenerFunction","eventRemoveLayerListenerFunction","payload","payloadIsRemoveGeoViewLayer","orderedLayers","filter","layerId","geoviewLayer","geoviewLayerId","eventAddLayerListenerFunction","payloadIsALayerConfig","event","on","eventNames","LAYER","EVENT_LAYER_ADDED","off","concat","layerConfig","MAP","EVENT_MAP_LOADED","EVENT_REMOVE_LAYER","EVENT_ADD_LAYER","createLegend","layerIds","isRemoveable","canSetOpacity","canZoomTo","_jsx","children","DataTable","table","setTable","createDataTable","_ref2","_asyncToGenerator","_regeneratorRuntime","_callee","data","_context","prev","next","dataTable","createDataPanel","sent","stop","apply","arguments","getDataTable","setTimeout","Layers","layers","setLayers","createLayers","TimeSlider","slider","setSlider","createTimeSlider","timeSlider","getTimeSlider","FooterPanelPlugin","_AbstractPlugin","_inherits","_super","_createSuper","pluginId","props","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","schema","toJsonObject","defaultConfig","en","details","fr","configObj","pluginProps","_api$maps$mapId","displayLanguage","footerTabs","defaultTabs","tabs","tabsCounter","includes","createFooterTab","value","label","translations","content","icon","HubOutlinedIcon","LayersOutlinedIcon","detailsTabValue","createDetails","InfoOutlinedIcon","GET_FEATURE_INFO","ALL_QUERIES_DONE","payloadIsAllQueriesDone","eventType","resultSets","features","Object","keys","forEach","layerPath","length","selectFooterTab","StorageIcon","customTabs","i","tab","title","contentHTML","buttonPanel","_createClass","key","AbstractPlugin","plugins","Cast"],"sourceRoot":""}