"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[286],{30451:(e,t,a)=>{var i=a(71292),n=a(84702),s=a(40019),r=a(89510),o=a(92746),p=a(7576),l=a(73110),c=a(55838),d=a(94201),m=a(26281),u=a(33457),f=a(3688),b=a.n(f),h=a(45202),y=window;function g(e){var t=e.mapId,a=e.config,i=y.cgpv,n=i.api.map(t),s=i.api,r=i.react,o=i.ui,p=o.elements.Select,l=r.useState,f=r.useEffect,g=o.makeStyles((function(){return{listContainer:{marginTop:"10px",height:"95%"},active:{boxShadow:"0 8px 16px 0 rgba(255, 255, 255, 0.8) !important"},card:{transition:"0.3s",borderRadius:"5px","&:hover":{boxShadow:"0 8px 16px 0 rgba(255, 255, 255, 0.4)"},marginBottom:10,height:"250px",width:"100%",display:"block",position:"relative"},thumbnail:{borderRadius:"5px",position:"absolute",height:"100%",width:"100%",opacity:.8,objectFit:"cover"},container:{background:"rgba(0,0,0,.68)",color:"#fff",overflow:"hidden",textOverflow:"ellipsis",height:"40px",display:"flex",alignItems:"center",padding:"0 5px",boxSizing:"border-box",position:"absolute",left:0,bottom:0,width:"inherit"}}}))(),v=l([]),j=(0,u.Z)(v,2),x=j[0],w=j[1],P=l(""),Z=(0,u.Z)(P,2),B=Z[0],C=Z[1],N=l(a.canSwichProjection),I=(0,u.Z)(N,1)[0],A=a.supportedProjections.map((function(e){return null==e?void 0:e.projectionCode}))||[],S=l(n.mapFeaturesConfig.map.viewSettings.projection),k=(0,u.Z)(S,2),O=k[0],$=k[1],q=function(e){n.basemap.setBasemap(e),C(e)},R=function(){var e=(0,m.Z)(b().mark((function e(i){var r,o,p,l,m,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(0,c.ZQJ)(a.supportedProjections.find((function(e){return e.projectionCode===i}))),o=!1,s.map(t).basemap.basemaps=[],w([]),p=function(e){var a=r.customBasemaps[e],i=s.map(t).basemap.createCustomBasemap(a);i&&w((function(e){return[].concat((0,d.Z)(e),[i])})),i&&0===e&&""===B&&(q(i.id),o=!0)},l=0;l<r.customBasemaps.length;l++)p(l);m=b().mark((function e(a){var n,p,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.coreBasemaps[a],e.next=3,s.map(t).basemap.createCoreBasemap(n,i);case 3:(p=e.sent)&&w((function(e){return[].concat((0,d.Z)(e),[p])})),l="".concat(n.shaded?"shaded":"").concat(n.id).concat(n.labeled?"label":""),p&&l===B&&!o&&(q(B),o=!0);case 7:case"end":return e.stop()}}),e)})),u=0;case 8:if(!(u<r.coreBasemaps.length)){e.next=13;break}return e.delegateYield(m(u),"t0",10);case 10:u++,e.next=8;break;case 13:o||q(n.basemap.basemaps[0].id);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return f((function(){R(O)}),[]),(0,h.jsxs)("div",{children:[I&&(0,h.jsx)(p,{fullWidth:!0,labelId:"projection-label",value:O,onChange:function(e){var a=e.target.value;q("nogeom"),$(a);var i=n.getView(),r=i.getCenter(),o=i.getProjection().getCode(),p=s.projection.transformPoints(r,o,"EPSG:4326")[0],l=e.target.value,d={zoom:i.getZoom(),minZoom:i.getMinZoom(),maxZoom:i.getMaxZoom(),center:p,projection:l};n.setView(d),R(a),s.event.emit((0,c.ltv)(s.eventNames.MAP.EVENT_MAP_VIEW_PROJECTION_CHANGE,t,a))},label:"Projection",style:{display:a.canSwichProjection?"flex":"none"},inputLabel:{id:"projection-label"},menuItems:A.map((function(e){return{key:e,item:{value:e,children:"EPSG:".concat(e)}}}))}),(0,h.jsx)("div",{className:g.listContainer,children:x.map((function(e){return(0,h.jsxs)("div",{role:"button",tabIndex:0,className:"".concat(g.card," ").concat(e.id===B?g.active:""),onClick:function(){return q(e.id)},onKeyPress:function(){return q(e.id)},children:["string"==typeof e.thumbnailUrl&&(0,h.jsx)("img",{src:e.thumbnailUrl,alt:e.altText,className:g.thumbnail}),Array.isArray(e.thumbnailUrl)&&e.thumbnailUrl.map((function(t,a){return(0,h.jsx)("img",{src:t,alt:e.altText,className:g.thumbnail},a)})),(0,h.jsx)("div",{className:g.container,children:e.name})]},e.id)}))})]})}const v=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"GeoView Basemap Panel Schema","type":"object","version":1,"comments":"Configuration for GeoView basemap switcher panel package.","additionalProperties":false,"definitions":{"basemapNameNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"The display name of the layer."},"basemapDescriptionNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"Basemap description."},"thumbnailUrlNode":{"type":"object","properties":{"en":{"type":"array","uniqueItems":true,"items":{"type":"string"}},"fr":{"type":"array","uniqueItems":true,"items":{"type":"string"}}},"description":"Basemap thumbnail urls."},"basemapLayerUrlNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"The service endpoint of the basemap layer."},"basemapAttributionNode":{"type":"object","properties":{"en":{"type":"string"},"fr":{"type":"string"}},"description":"Basemap attribution text."},"basemapLayersNode":{"type":"object","properties":{"id":{"type":"string","description":"the id of the layer."},"url":{"$ref":"#/definitions/basemapLayerUrlNode"},"opacity":{"type":"number","description":"the opacity of this layer.","default":0}},"additionalItems":false,"required":["id","url"]},"basemap":{"type":"object","properties":{"id":{"type":"string","description":"the basemap id","enum":["transport","simple","shaded","osm","nogeom"]},"shaded":{"type":"boolean","description":"if a shaded layer should be included with this basemap.","default":false},"labeled":{"type":"boolean","description":"if labels should be enabled in this basemap.","default":false}},"additionalProperties":false,"required":["id","shaded","labeled"]},"customBasemap":{"type":"object","properties":{"id":{"type":"string","description":"the basemap id."},"name":{"$ref":"#/definitions/basemapNameNode"},"description":{"$ref":"#/definitions/basemapDescriptionNode"},"thumbnailUrl":{"$ref":"#/definitions/thumbnailUrlNode"},"layers":{"type":"array","description":"a list of basemap layers","items":{"$ref":"#/definitions/basemapLayersNode"},"minItems":1},"attribution":{"$ref":"#/definitions/basemapAttributionNode"},"zoomLevels":{"type":"object","description":"Zoom levels for the basemap","properties":{"min":{"type":"integer","minimum":0,"maximum":24,"default":0},"max":{"type":"integer","minimum":0,"maximum":24,"default":24}},"additionalProperties":false,"required":["min","max"]}},"additionalProperties":false,"required":["id","name","description","layers"]}},"properties":{"isOpen":{"type":"boolean","description":"Specifies whether the basemap switcher panel is initially open or closed","default":false},"canSwichProjection":{"type":"boolean","description":"Allow the user to switch projection from the basemap switcher panel.","default":true},"supportedProjections":{"type":"array","items":{"type":"object","properties":{"projectionCode":{"type":"integer","enum":[3978,3857],"description":"Default projection to load on start."},"customBasemaps":{"type":"array","description":"A list of custom basemaps.","items":{"$ref":"#/definitions/customBasemap"},"minItems":0},"coreBasemaps":{"type":"array","description":"A list of basemaps available in the core to show in the panel.","items":{"$ref":"#/definitions/basemap"},"minItems":1}}},"minItems":1,"required":["coreBasemaps","customBasemaps"]},"languages":{"type":"array","uniqueItems":true,"items":{"type":"string","enum":["en-CA","fr-CA"]},"default":["en-CA","fr-CA"],"description":"ISO 639-1 code indicating the languages supported by the configuration file.","minItems":1},"version":{"type":"string","enum":["1.0"],"description":"The schema version used to validate the configuration file. The schema should enumerate the list of versions accepted by this version of the viewer."}},"required":["canSwichProjection","supportedProjections","languages"]}'),j=JSON.parse('{"isOpen":false,"canSwichProjection":false,"supportedProjections":[{"projectionCode":3978,"coreBasemaps":[{"id":"transport","shaded":true,"labeled":true},{"id":"transport","shaded":true,"labeled":false},{"id":"osm","shaded":true,"labeled":false},{"id":"simple","shaded":true,"labeled":false},{"id":"shaded","shaded":true,"labeled":false},{"id":"nogeom","shaded":false,"labeled":false}],"customBasemaps":[]},{"projectionCode":3857,"coreBasemaps":[{"id":"transport","shaded":true,"labeled":true},{"id":"transport","shaded":true,"labeled":false},{"id":"osm","shaded":true,"labeled":false},{"id":"simple","shaded":true,"labeled":false},{"id":"shaded","shaded":true,"labeled":false},{"id":"nogeom","shaded":false,"labeled":false}],"customBasemaps":[]}],"suportedLanguages":["en-CA","fr-CA"]}');function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,i=(0,p.Z)(e);if(t){var n=(0,p.Z)(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return(0,o.Z)(this,a)}}var w=window,P=function(e){(0,r.Z)(a,e);var t=x(a);function a(e,n){var r;return(0,i.Z)(this,a),r=t.call(this,e,n),(0,l.Z)((0,s.Z)(r),"schema",(function(){return v})),(0,l.Z)((0,s.Z)(r),"defaultConfig",(function(){return(0,c.ZQJ)(j)})),(0,l.Z)((0,s.Z)(r),"translations",(0,c.ZQJ)({"en-CA":{basemapPanel:"Basemaps"},"fr-CA":{basemapPanel:"Fond de carte"}})),(0,l.Z)((0,s.Z)(r),"added",(function(){var e=(0,s.Z)(r),t=e.configObj,a=e.pluginProps.mapId,i=w.cgpv;if(i){var n,o,p=i.api,l=i.ui.elements.MapIcon,c=p.map(a).displayLanguage,d={id:"basemapPanelButton",tooltip:r.translations[c].basemapPanel,tooltipPlacement:"right",children:(0,h.jsx)(l,{}),visible:!0},m={title:r.translations[c].basemapPanel,icon:'<i class="material-icons">map</i>',width:200,status:null==t?void 0:t.isOpen};r.buttonPanel=p.map(a).appBarButtons.createAppbarPanel(d,m,null),null===(n=r.buttonPanel)||void 0===n||null===(o=n.panel)||void 0===o||o.changeContent((0,h.jsx)(g,{mapId:a,config:t||{}}))}})),r.buttonPanel=null,r}return(0,n.Z)(a,[{key:"removed",value:function(){var e=this.pluginProps.mapId,t=w.cgpv;if(t){var a=t.api;this.buttonPanel&&(a.map(e).appBarButtons.removeAppbarPanel(this.buttonPanel.id),a.map(e).basemap.basemaps=[],a.map(e).basemap.loadDefaultBasemaps())}}}]),a}(c.Vw$);w.plugins=w.plugins||{},w.plugins["basemap-panel"]=(0,c.RFZ)(P)}},e=>{var t;t=30451,e(e.s=t)}]);
//# sourceMappingURL=geoview-basemap-panel.js.map