{"version":3,"file":"corePackages/geoview-basemap-panel.js","mappings":"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","sources":["webpack://geoview-core/../geoview-basemap-panel/src/basemap-panel.tsx","webpack://geoview-core/../geoview-basemap-panel/src/index.tsx"],"sourcesContent":["import {\n  toJsonObject,\n  TypeBasemapProps,\n  TypeJsonObject,\n  TypeJsonArray,\n  SelectChangeEvent,\n  TypeWindow,\n  TypeViewSettings,\n  mapViewProjectionPayload,\n  TypeBasemapOptions,\n  TypeValidMapProjectionCodes,\n} from 'geoview-core';\n\nconst w = window as TypeWindow;\n\ninterface BaseMapPanelProps {\n  mapId: string;\n  config: TypeJsonObject;\n}\n\nexport function BasemapPanel(props: BaseMapPanelProps): JSX.Element {\n  const { mapId, config } = props;\n\n  const { cgpv } = w;\n  const myMap = cgpv.api.maps[mapId];\n\n  const { api, ui, react } = cgpv;\n  const { Select, Card } = ui.elements;\n\n  const { useState, useEffect } = react;\n\n  const [basemapList, setBasemapList] = useState<TypeBasemapProps[]>([]);\n  const [activeBasemapId, setActiveBasemapId] = useState<string>('');\n  const [canSwichProjection] = useState(config.canSwichProjection);\n\n  const useStyles = ui.makeStyles((theme) => ({\n    basemapCard: {\n      backgroundColor: theme.palette.grey.A700,\n      color: theme.palette.primary.light,\n      display: 'flex',\n      flexDirection: 'column',\n      backgroundClip: 'padding-box',\n      border: `1px solid ${theme.basemapPanel.borderDefault}`,\n      borderRadius: 6,\n      boxShadow: 'none',\n      marginBottom: 16,\n      transition: 'all 0.3s ease-in-out',\n      '&:last-child': {\n        marginBottom: 0,\n      },\n      '& .MuiCardHeader-root': {\n        backgroundColor: theme.palette.grey.A700,\n        color: theme.basemapPanel.header,\n        fontSize: 14,\n        fontWeight: 400,\n        margin: 0,\n        padding: '0 12px',\n        height: 60,\n        width: '100%',\n        order: 2,\n      },\n      '& .MuiCardContent-root': {\n        order: 1,\n        height: 190,\n        position: 'relative',\n        padding: 0,\n        '&:last-child': {\n          padding: 0,\n        },\n        '& .basemapCardThumbnail': {\n          position: 'absolute',\n          height: '100%',\n          width: '100%',\n          objectFit: 'cover',\n          top: 0,\n          left: 0,\n        },\n        '& .basemapCardThumbnailOverlay': {\n          display: 'block',\n          height: '100%',\n          width: '100%',\n          position: 'absolute',\n          backgroundColor: theme.basemapPanel.overlayDefault,\n          transition: 'all 0.3s ease-in-out',\n        },\n      },\n      '&:hover': {\n        cursor: 'pointer',\n        borderColor: theme.basemapPanel.borderHover,\n        '& .MuiCardContent-root': {\n          '& .basemapCardThumbnailOverlay': {\n            backgroundColor: theme.basemapPanel.overlayHover,\n          },\n        },\n      },\n      '&.active': {\n        borderColor: theme.basemapPanel.borderActive,\n        '& .MuiCardContent-root': {\n          '& .basemapCardThumbnailOverlay': {\n            backgroundColor: theme.basemapPanel.overlayActive,\n          },\n        },\n        '&:hover': {\n          borderColor: 'rgba(255,255,255,0.75)',\n          '& .MuiCardContent-root': {\n            '& .basemapCardThumbnailOverlay': {\n              backgroundColor: 'rgba(0,0,0,0)',\n            },\n          },\n        },\n      },\n    },\n  }));\n  const classes = useStyles();\n\n  // TODO: change the path for getting projection on schema refactor\n  const projections: number[] =\n    (config.supportedProjections as TypeJsonArray).map((obj: TypeJsonObject) => obj?.projectionCode as number) || [];\n  const [mapProjection, setMapProjection] = useState(myMap.mapFeaturesConfig.map.viewSettings.projection);\n\n  /**\n   * Update the basemap with the layers on the map\n   *\n   * @param {string} id update the basemap on the map\n   */\n  const setBasemap = (basemapId: string) => {\n    // set the new basemap and update the active basemap variable\n    myMap.basemap.setBasemap(basemapId);\n    setActiveBasemapId(basemapId);\n  };\n\n  /**\n   *  Add basemaps from configuration for selected projection\n   *\n   * @param {number} projection the projection to create basemaps for\n   */\n  const createBasemapArray = async (projection: TypeValidMapProjectionCodes) => {\n    const basemapsArray = toJsonObject(\n      (config.supportedProjections as Array<TypeJsonObject>).find((obj: TypeJsonObject) => obj.projectionCode === projection)\n    );\n    let isInit = false;\n\n    // reset the basemaps array\n    api.maps[mapId].basemap.basemaps = [];\n    setBasemapList([]);\n\n    // create the custom config basemap\n    for (let basemapIndex = 0; basemapIndex < (basemapsArray.customBasemaps.length as number); basemapIndex++) {\n      const customBasemap = basemapsArray.customBasemaps[basemapIndex] as TypeJsonObject;\n      const basemap = api.maps[mapId].basemap.createCustomBasemap(customBasemap as unknown as TypeBasemapProps);\n      if (basemap) setBasemapList((prevArray) => [...prevArray, basemap]);\n\n      // custom basemap are provided set it by default (can't be set as basemap from geoview config)\n      if (basemap && basemapIndex === 0 && activeBasemapId === '') {\n        setBasemap(basemap.basemapId!);\n        isInit = true;\n      }\n    }\n\n    // create the core basemap\n    for (let basemapIndex = 0; basemapIndex < (basemapsArray.coreBasemaps.length as number); basemapIndex++) {\n      const basemapOptions = basemapsArray.coreBasemaps[basemapIndex] as TypeJsonObject;\n      // eslint-disable-next-line no-await-in-loop\n      const basemap = await api.maps[mapId].basemap.createCoreBasemap(basemapOptions as unknown as TypeBasemapOptions, projection);\n      if (basemap) setBasemapList((prevArray) => [...prevArray, basemap]);\n\n      // set basemap if previously selected in previous projection\n      const id = `${basemapOptions.shaded ? 'shaded' : ''}${basemapOptions.id}${basemapOptions.labeled ? 'label' : ''}`;\n      if (basemap && id === activeBasemapId && !isInit) {\n        setBasemap(activeBasemapId);\n        isInit = true;\n      }\n    }\n\n    // if previous basemap does not exist in previous projection, init first one\n    if (!isInit) setBasemap(myMap.basemap.basemaps[0].basemapId as string);\n  };\n\n  /**\n   * Set new projection view and basemap array\n   *\n   * @param {SelectChangeEvent} event select change element event\n   */\n  const setSelectedProjection = (event: SelectChangeEvent<unknown>) => {\n    const projection = event.target.value as TypeValidMapProjectionCodes;\n\n    // set basemap to no geom to clean up the view\n    setBasemap('nogeom');\n    setMapProjection(projection as TypeValidMapProjectionCodes);\n\n    // get view status (center and projection) to calculate new center\n    const currentView = myMap.getView();\n    const currentCenter = currentView.getCenter();\n    const currentProjection = currentView.getProjection().getCode();\n    const newCenter = api.projection.transformPoints(currentCenter, currentProjection, 'EPSG:4326')[0];\n    const newProjection = event.target.value as TypeValidMapProjectionCodes;\n\n    const newView: TypeViewSettings = {\n      zoom: currentView.getZoom() as number,\n      minZoom: currentView.getMinZoom(),\n      maxZoom: currentView.getMaxZoom(),\n      center: newCenter as [number, number],\n      projection: newProjection,\n    };\n\n    // set new view and basemaps array (with selected basemap)\n    myMap.setView(newView);\n    createBasemapArray(projection);\n\n    // emit an event to let know map view projection as changed\n    api.event.emit(mapViewProjectionPayload(api.eventNames.MAP.EVENT_MAP_VIEW_PROJECTION_CHANGE, mapId, projection));\n  };\n\n  /**\n   * load existing basemaps and create new basemaps\n   */\n  useEffect(() => {\n    createBasemapArray(mapProjection);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div>\n      {canSwichProjection && (\n        <Select\n          fullWidth\n          labelId=\"projection-label\"\n          value={mapProjection}\n          onChange={setSelectedProjection}\n          label=\"Projection\"\n          style={{\n            display: config.canSwichProjection ? 'flex' : 'none',\n          }}\n          inputLabel={{\n            id: 'projection-label',\n          }}\n          menuItems={projections.map((value: number) => ({\n            key: value,\n            item: {\n              value,\n              children: `EPSG:${value}`,\n            },\n          }))}\n        />\n      )}\n      {basemapList.map((basemap: TypeBasemapProps) => {\n        return (\n          <Card\n            tabIndex={0}\n            classes={{ root: classes.basemapCard }}\n            className={basemap.basemapId === activeBasemapId ? 'active' : ''}\n            onClick={() => setBasemap(basemap.basemapId as string)}\n            onKeyPress={() => setBasemap(basemap.basemapId as string)}\n            key={basemap.basemapId}\n            title={basemap.name}\n            contentCard={\n              <>\n                {typeof basemap.thumbnailUrl === 'string' && (\n                  <img src={basemap.thumbnailUrl} alt={basemap.altText} className=\"basemapCardThumbnail\" />\n                )}\n                {Array.isArray(basemap.thumbnailUrl) &&\n                  (basemap.thumbnailUrl as string[]).map((thumbnail, index) => {\n                    // eslint-disable-next-line react/no-array-index-key\n                    return <img key={index} src={thumbnail} alt={basemap.altText} className=\"basemapCardThumbnail\" />;\n                  })}\n                <div className=\"basemapCardThumbnailOverlay\" />\n              </>\n            }\n          />\n        );\n      })}\n    </div>\n  );\n}\n","import {\n  Cast,\n  AbstractPlugin,\n  TypePluginOptions,\n  TypeIconButtonProps,\n  TypeButtonPanel,\n  TypeWindow,\n  toJsonObject,\n  TypePanelProps,\n  TypeJsonObject,\n  AnySchemaObject,\n} from 'geoview-core';\n\nimport { BasemapPanel } from './basemap-panel';\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-basemap-panel.json';\n\nconst w = window as TypeWindow;\n\n/**\n * Create a class for the plugin instance\n */\nclass BasemapPanelPlugin extends AbstractPlugin {\n  // store the created button panel object\n  buttonPanel: TypeButtonPanel | null;\n\n  constructor(pluginId: string, props: TypePluginOptions) {\n    super(pluginId, props);\n    this.buttonPanel = null;\n  }\n\n  /**\n   * Return the package schema\n   *\n   * @returns {AnySchemaObject} the package schema\n   */\n  schema = (): AnySchemaObject => schema;\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  defaultConfig = (): TypeJsonObject => toJsonObject(defaultConfig);\n\n  /**\n   * translations object to inject to the viewer translations\n   */\n  translations = toJsonObject({\n    en: {\n      basemapPanel: 'Basemaps',\n    },\n    fr: {\n      basemapPanel: 'Fond de carte',\n    },\n  });\n\n  /**\n   * Added function called after the plugin has been initialized\n   */\n  added = (): void => {\n    const { configObj, pluginProps } = this as AbstractPlugin;\n\n    const { mapId } = pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      const { api, ui } = cgpv;\n      const { MapIcon } = ui.elements;\n      const { displayLanguage } = api.maps[mapId];\n      // button props\n      const button: TypeIconButtonProps = {\n        id: 'basemapPanelButton',\n        tooltip: this.translations[displayLanguage].basemapPanel as string,\n        tooltipPlacement: 'right',\n        children: <MapIcon />,\n        visible: true,\n      };\n\n      // panel props\n      const panel: TypePanelProps = {\n        title: this.translations[displayLanguage].basemapPanel,\n        icon: '<i class=\"material-icons\">map</i>',\n        width: 350,\n        status: configObj?.isOpen as boolean,\n      };\n\n      // create a new button panel on the app-bar\n      this.buttonPanel = api.maps[mapId].appBarButtons.createAppbarPanel(button, panel, null);\n      // set panel content\n      this.buttonPanel?.panel?.changeContent(<BasemapPanel mapId={mapId} config={configObj || {}} />);\n    }\n  };\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  removed(): void {\n    const { mapId } = (this as AbstractPlugin).pluginProps;\n\n    // access the cgpv object from the window object\n    const { cgpv } = w;\n\n    if (cgpv) {\n      // access the api calls\n      const { api } = cgpv;\n\n      if (this.buttonPanel) {\n        api.maps[mapId].appBarButtons.removeAppbarPanel(this.buttonPanel.buttonPanelId);\n\n        // reset basemaps array\n        api.maps[mapId].basemap.basemaps = [];\n        // reload default basemap\n        api.maps[mapId].basemap.loadDefaultBasemaps();\n      }\n    }\n  }\n}\n\nexport default BasemapPanelPlugin;\n\nw.plugins = w.plugins || {};\nw.plugins['basemap-panel'] = Cast<AbstractPlugin>(BasemapPanelPlugin);\n"],"names":["w","window","BasemapPanel","props","mapId","config","cgpv","myMap","api","maps","ui","react","_ui$elements","elements","Select","Card","useState","useEffect","_useState","_useState2","_slicedToArray","basemapList","setBasemapList","_useState3","_useState4","activeBasemapId","setActiveBasemapId","_useState5","canSwichProjection","classes","makeStyles","theme","basemapCard","backgroundColor","palette","grey","A700","color","primary","light","display","flexDirection","backgroundClip","border","concat","basemapPanel","borderDefault","borderRadius","boxShadow","marginBottom","transition","header","fontSize","fontWeight","margin","padding","height","width","order","position","objectFit","top","left","overlayDefault","cursor","borderColor","borderHover","overlayHover","borderActive","overlayActive","useStyles","projections","supportedProjections","map","obj","projectionCode","_useState7","mapFeaturesConfig","viewSettings","projection","_useState8","mapProjection","setMapProjection","setBasemap","basemapId","basemap","createBasemapArray","_ref","_asyncToGenerator","_regeneratorRuntime","_callee","basemapsArray","isInit","_loop","basemapIndex","_loop2","_basemapIndex","_context3","prev","next","toJsonObject","find","basemaps","customBasemap","_context","customBasemaps","createCustomBasemap","prevArray","_toConsumableArray","stop","length","delegateYield","basemapOptions","id","_context2","coreBasemaps","createCoreBasemap","sent","shaded","labeled","_x","apply","arguments","_jsxs","children","_jsx","fullWidth","labelId","value","onChange","event","target","currentView","getView","currentCenter","getCenter","currentProjection","getProjection","getCode","newCenter","transformPoints","newProjection","newView","zoom","getZoom","minZoom","getMinZoom","maxZoom","getMaxZoom","center","setView","emit","mapViewProjectionPayload","eventNames","MAP","EVENT_MAP_VIEW_PROJECTION_CHANGE","label","style","inputLabel","menuItems","key","item","tabIndex","root","className","onClick","onKeyPress","title","name","contentCard","_Fragment","thumbnailUrl","src","alt","altText","Array","isArray","thumbnail","index","BasemapPanelPlugin","_AbstractPlugin","_inherits","_super","_createSuper","pluginId","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","schema","defaultConfig","en","fr","configObj","pluginProps","_this$buttonPanel","MapIcon","displayLanguage","button","tooltip","translations","tooltipPlacement","visible","panel","icon","status","isOpen","buttonPanel","appBarButtons","createAppbarPanel","changeContent","_createClass","this","removeAppbarPanel","buttonPanelId","loadDefaultBasemaps","AbstractPlugin","plugins","Cast"],"sourceRoot":""}