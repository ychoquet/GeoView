"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[375],{1786:(e,t,n)=>{var o=n(6482),a=n(3915),i=n(632),r=n(6712),s=n(2303),l=n(8792),c=n(3744),p=n(3547),u=n(1565),d=n(5202),m=window.cgpv,g=m.api,f=m.react,h=m.reactLeaflet,v=m.reactLeafletCore,x=g.eventNames,C=f.useState,w=f.useEffect,y=f.useCallback,b=f.useMemo,E=h.useMapEvent,Z=v.useEventHandlers;function k(e){var t=e.parentId,n=e.parentMap,o=e.zoomFactor,a=e.minimap,i=C(!1),r=(0,u.Z)(i,2),s=r[0],l=r[1],c=y((function(e){n.setView(e.latlng,n.getZoom())}),[n]);E("click",c);var p=C({height:0,width:0,top:0,left:0}),m=(0,u.Z)(p,2),f=m[0],h=m[1];function v(){var e=n.getZoom()-o>0?n.getZoom()-o:0;a.flyTo(n.getCenter(),e),setTimeout((function(){a.invalidateSize();var e=a.latLngToContainerPoint(n.getBounds().getSouthWest()),t=a.latLngToContainerPoint(n.getBounds().getNorthEast());h({height:e.y-t.y,width:t.x-e.x,top:t.y,left:e.x})}),500)}w((function(){return v(),g.event.on(x.EVENT_OVERVIEW_MAP_TOGGLE,(function(e){e&&t===e.handlerName&&(v(),l(e.status))}),t),function(){g.event.off(x.EVENT_OVERVIEW_MAP_TOGGLE,t)}}),[]);var k=y((function(){v()}),[a,n,o]),z=b((function(){return{moveend:k,zoomend:k}}),[k]);return Z({instance:n,context:{__version:1,map:n}},z),s?(0,d.jsx)("div",{}):(0,d.jsx)("div",{style:{left:"".concat(f.left,"px"),top:"".concat(f.top,"px"),width:"".concat(f.width,"px"),height:"".concat(f.height,"px"),display:"block",opacity:.5,position:"absolute",border:"1px solid rgb(0, 0, 0)",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}})}var z=window.cgpv,I=z.api,j=z.react,T=z.leaflet,M=z.ui,P=z.constants,R=z.useTranslation,_=I.eventNames,L=j.useState,N=j.useEffect,O=j.useRef,B=T.DomEvent,V=M.elements,S=V.IconButton,F=V.ChevronLeftIcon,A=P.leafletPositionClasses,G=M.makeStyles((function(e){return{toggleBtn:{transform:"rotate(45deg)",color:e.palette.primary.contrastText,zIndex:e.zIndex.tooltip},toggleBtnContainer:{zIndex:e.zIndex.tooltip},minimapOpen:{transform:"rotate(-45deg)"},minimapClosed:{transform:"rotate(135deg)"}}}));function W(e){var t=e.parentId,n=e.minimap,o=O(null),a=R().t,i=L(!0),r=(0,u.Z)(i,2),s=r[0],l=r[1],c=G(),m=M.useTheme();return N((function(){B.disableClickPropagation((0,p.RF)(o.current))}),[]),(0,d.jsx)("div",{ref:o,className:"".concat(A.topright," ").concat(c.toggleBtnContainer),children:(0,d.jsx)(S,{className:"leaflet-control ".concat(c.toggleBtn," ").concat(s?c.minimapClosed:c.minimapOpen),style:{margin:"-".concat(m.spacing(3)),padding:0,height:"initial",minWidth:"initial"},"aria-label":a("mapctrl.overviewmap.toggle"),onClick:function(){return function(){if(l(!s),s){var e,o=null===(e=m.overrides.button)||void 0===e?void 0:e.size;n.getContainer().style.width=o.width,n.getContainer().style.height=o.height}else n.getContainer().style.width=D.width,n.getContainer().style.height=D.height;I.event.emit(_.EVENT_OVERVIEW_MAP_TOGGLE,t,{status:s})}()},size:"large",children:(0,d.jsx)(F,{})})})}var D={width:"150px",height:"150px"},H=window.cgpv,Q=H.api,q=H.react,J=H.leaflet,K=H.reactLeaflet,U=H.ui,X=H.constants,Y=q.useState,$=q.useEffect,ee=q.useRef,te=q.useMemo,ne=J.DomEvent,oe=K.MapContainer,ae=K.TileLayer,ie=K.useMap,re=U.useMediaQuery,se=U.useTheme,le=U.makeStyles,ce=X.leafletPositionClasses,pe=le((function(e){return{minimap:{width:D.width,height:D.height,"-webkit-transition":"300ms linear","-moz-transition":"300ms linear","-o-transition":"300ms linear","-ms-transition":"300ms linear",transition:"300ms linear","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,borderTop:"32px solid hsla(0,0%,98%,0.9)",borderLeft:"32px solid transparent",zIndex:e.zIndex.appBar,right:0,top:0}}}}));function ue(e){var t=e.id,n=e.crs,o=e.zoomFactor,a=Y(),i=(0,u.Z)(a,2),r=i[0],s=i[1],l=pe(),c=se(),m=re(c.breakpoints.up("md")),g=ie(),f=g.getZoom()-o>0?g.getZoom()-o:0,h=Q.map(t).basemap.getBasemapLayers(),v=ee(null);$((function(){var e=(0,p.RF)(v.current);e&&(ne.disableClickPropagation(e),ne.disableScrollPropagation(e))}),[]);var x=te((function(){return(0,d.jsx)(oe,{className:l.minimap,center:g.getCenter(),zoom:f,crs:n,dragging:!1,doubleClickZoom:!1,scrollWheelZoom:!1,attributionControl:!1,zoomControl:!1,whenCreated:function(e){var t=e.getContainer();ne.disableClickPropagation(t),ne.disableScrollPropagation(t),t.parentElement.style.margin=c.spacing(3),s(e)},children:r?(0,d.jsxs)(d.Fragment,{children:[h.map((function(e){return(0,d.jsx)(ae,{url:e.url},e.id)})),(0,d.jsx)(k,{parentId:t,parentMap:g,minimap:r,zoomFactor:o}),(0,d.jsx)(W,{parentId:t,minimap:r})]}):(0,d.jsx)("div",{})})}),[g,n,f,h,o,r]);return m?(0,d.jsx)("div",{className:ce.topright,children:(0,d.jsx)("div",{ref:v,className:"leaflet-control leaflet-bar",children:x})}):(0,d.jsx)("div",{})}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,s.Z)(this,n)}}var me=window,ge=function(e){(0,r.Z)(n,e);var t=de(n);function n(){var e;(0,o.Z)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r)),(0,c.Z)((0,i.Z)(e),"translations",{"en-CA":{},"fr-CA":{}}),(0,c.Z)((0,i.Z)(e),"added",(function(){var t=e.pluginOptions.mapId,n=me.cgpv.api,o=n.map(t),a=o.language,i=o.projection,r=o.getMapOptions,s=o.currentProjection;n.map(t).addComponent("overviewMap",(0,d.jsx)(ue,{id:t,language:a,crs:i.getCRS(),zoomFactor:r(s).zoomFactor}))})),e}return(0,a.Z)(n,[{key:"removed",value:function(){var e=this.pluginOptions.mapId;me.cgpv.api.map(e).removeComponent("overviewMap")}}]),n}(p.EV);me.plugins=me.plugins||{},me.plugins.overviewMap=(0,p.RF)(ge)}},e=>{var t;t=1786,e(e.s=t)}]);