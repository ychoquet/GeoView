"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[375],{1786:(e,t,n)=>{var a=n(6482),i=n(3915),o=n(3744),r=n(1565),s=n(619),l=n(5202),c=window.cgpv,p=c.api,u=c.react,m=c.reactLeaflet,g=c.reactLeafletCore,d=p.eventNames,h=u.useState,v=u.useEffect,f=u.useCallback,x=u.useMemo,C=m.useMapEvent,w=g.useEventHandlers;function b(e){var t=e.parentId,n=e.parentMap,a=e.zoomFactor,i=e.minimap,o=h(!1),s=(0,r.Z)(o,2),c=s[0],u=s[1],m=f((function(e){n.setView(e.latlng,n.getZoom())}),[n]);C("click",m);var g=h({height:0,width:0,top:0,left:0}),b=(0,r.Z)(g,2),E=b[0],y=b[1];function k(){var e=n.getZoom()-a>0?n.getZoom()-a:0;i.flyTo(n.getCenter(),e),setTimeout((function(){i.invalidateSize();var e=i.latLngToContainerPoint(n.getBounds().getSouthWest()),t=i.latLngToContainerPoint(n.getBounds().getNorthEast());y({height:e.y-t.y,width:t.x-e.x,top:t.y,left:e.x})}),500)}v((function(){return k(),p.event.on(d.EVENT_OVERVIEW_MAP_TOGGLE,(function(e){e&&t===e.handlerName&&(k(),u(e.status))}),t),function(){p.event.off(d.EVENT_OVERVIEW_MAP_TOGGLE,t)}}),[]);var z=f((function(){k()}),[i,n,a]),P=x((function(){return{moveend:z,zoomend:z}}),[z]);return w({instance:n,context:{__version:1,map:n}},P),c?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)("div",{style:{left:"".concat(E.left,"px"),top:"".concat(E.top,"px"),width:"".concat(E.width,"px"),height:"".concat(E.height,"px"),display:"block",opacity:.5,position:"absolute",border:"1px solid rgb(0, 0, 0)",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}})}var E=window.cgpv,y=E.api,k=E.react,z=E.leaflet,P=E.ui,I=E.constants,M=E.useTranslation,j=y.eventNames,T=k.useState,Z=k.useEffect,_=k.useRef,L=z.DomEvent,N=P.elements,O=N.IconButton,F=N.ChevronLeftIcon,S=I.leafletPositionClasses,V=P.makeStyles((function(e){return{toggleBtn:{transform:"rotate(45deg)",color:e.palette.primary.contrastText,zIndex:e.zIndex.tooltip},toggleBtnContainer:{zIndex:e.zIndex.tooltip},minimapOpen:{transform:"rotate(-45deg)"},minimapClosed:{transform:"rotate(135deg)"}}}));function B(e){var t=e.parentId,n=e.minimap,a=_(null),i=M().t,o=T(!0),c=(0,r.Z)(o,2),p=c[0],u=c[1],m=V(),g=P.useTheme();return Z((function(){L.disableClickPropagation((0,s.RF)(a.current))}),[]),(0,l.jsx)("div",{ref:a,className:"".concat(S.topright," ").concat(m.toggleBtnContainer),children:(0,l.jsx)(O,{className:"leaflet-control ".concat(m.toggleBtn," ").concat(p?m.minimapClosed:m.minimapOpen),style:{margin:"-".concat(g.spacing(3)),padding:0,height:"initial",minWidth:"initial"},"aria-label":i("mapctrl.overviewmap.toggle"),onClick:function(){return function(){if(u(!p),p){var e,a,i=null===(e=g.overrides)||void 0===e||null===(a=e.button)||void 0===a?void 0:a.size;n.getContainer().style.width=i.width,n.getContainer().style.height=i.height}else n.getContainer().style.width=R.width,n.getContainer().style.height=R.height;y.event.emit(j.EVENT_OVERVIEW_MAP_TOGGLE,t,{status:p})}()},size:"large",children:(0,l.jsx)(F,{})})})}var R={width:"150px",height:"150px"},G=window.cgpv,W=G.api,A=G.react,D=G.leaflet,H=G.reactLeaflet,Q=G.ui,q=G.constants,J=A.useState,K=A.useEffect,U=A.useRef,X=A.useMemo,Y=D.DomEvent,$=H.MapContainer,ee=H.TileLayer,te=H.useMap,ne=Q.useMediaQuery,ae=Q.useTheme,ie=Q.makeStyles,oe=q.leafletPositionClasses,re=ie((function(e){return{minimap:{width:R.width,height:R.height,"-webkit-transition":"300ms linear","-moz-transition":"300ms linear","-o-transition":"300ms linear","-ms-transition":"300ms linear",transition:"300ms linear","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,borderTop:"32px solid hsla(0,0%,98%,0.9)",borderLeft:"32px solid transparent",zIndex:e.zIndex.appBar,right:0,top:0}}}}));function se(e){var t=e.id,n=e.crs,a=e.zoomFactor,i=J(),o=(0,r.Z)(i,2),c=o[0],p=o[1],u=re(),m=ae(),g=ne(m.breakpoints.up("md")),d=te(),h=d.getZoom()-a>0?d.getZoom()-a:0,v=W.map(t).basemap.getBasemapLayers(),f=U(null);K((function(){var e=(0,s.RF)(f.current);e&&(Y.disableClickPropagation(e),Y.disableScrollPropagation(e))}),[]);var x=X((function(){return(0,l.jsx)($,{className:u.minimap,center:d.getCenter(),zoom:h,crs:n,dragging:!1,doubleClickZoom:!1,scrollWheelZoom:!1,attributionControl:!1,zoomControl:!1,whenCreated:function(e){var t=e.getContainer();Y.disableClickPropagation(t),Y.disableScrollPropagation(t),t.parentElement.style.margin=m.spacing(3),p(e)},children:c?(0,l.jsxs)(l.Fragment,{children:[v.map((function(e){return(0,l.jsx)(ee,{url:e.url},e.id)})),(0,l.jsx)(b,{parentId:t,parentMap:d,minimap:c,zoomFactor:a}),(0,l.jsx)(B,{parentId:t,minimap:c})]}):(0,l.jsx)(l.Fragment,{})})}),[d,n,h,v,a,c]);return g?(0,l.jsx)("div",{className:oe.topright,children:(0,l.jsx)("div",{ref:f,className:"leaflet-control leaflet-bar",children:x})}):(0,l.jsx)(l.Fragment,{})}var le=window,ce=function(){function e(t,n){var i=this;(0,a.Z)(this,e),(0,o.Z)(this,"translations",{"en-CA":{},"fr-CA":{}}),(0,o.Z)(this,"added",(function(){var e=i.OverviewMapPluginProps.mapId,t=le.cgpv.api,n=t.map(e),a=n.language,o=n.projection,r=n.getMapOptions,s=n.currentProjection;t.map(e).addComponent("overviewMap",(0,l.jsx)(se,{id:e,language:a,crs:o.getCRS(),zoomFactor:r(s).zoomFactor}))})),this.id=t,this.OverviewMapPluginProps=n}return(0,i.Z)(e,[{key:"removed",value:function(){var e=this.OverviewMapPluginProps.mapId;le.cgpv.api.map(e).removeComponent("overviewMap")}}]),e}();le.plugins=le.plugins||{},le.plugins.overviewMap=ce}},e=>{var t;t=1786,e(e.s=t)}]);